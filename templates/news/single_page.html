{% extends "news/base.html" %}
{% load static %}


{% block title %}{{news.category.name}}{% endblock title %}




{% block content %}
<section id="contentSection">
    <div class="row">
        <div class="col-lg-8 col-md-8 col-sm-8">
            <div class="left_content">
                <div class="single_page">
                    <ol class="breadcrumb">
                        <li><a href="{% url 'home' %}">Home</a></li>
                        <li><a href="#">Technology</a></li>
                        <li class="active">{{ news.title }}</li> 
                    </ol>
                    <h1>{{ news.title }}</h1>
                    <div class="post_commentbox">
                        <span><i class="fa fa-calendar"></i>{{ news.publish_time }}</span> 
                        <a href="#"><i class="fa fa-tags"></i>{{ news.category.name }}</a>
                        <span><i class="fa fa-eye"></i>{% if news_hitcount %}{{ news_hitcount.hits }}{% else %}{{ news.views_count }}{% endif %}</span>
                        <span><i class="fa fa-comments"></i>{{ comments_count }}</span>
                    </div>
                    <div class="single_page_content">
                        <img class="img-center" src="{{ news.image.url }}" alt="{{ news.title }}">
                        <p>{{ news.body }}</p> 
                        <br> 

                        {% for comment in comments %}
                        <li>
                            <div class="media wow fadeInDown">
                                <div class="media-body">
                                    <img src="{{ comment.user.profile.photo.url }}" alt="{{ comment.user.username }}" class="img-circle" width="50" height="50">
                                    <strong>{{ comment.user.username }}</strong>
                                    <p>Time: {{ comment.created_on }}</p>
                                    <p>{{ comment.body }}</p>
                                </div>
                            </div>
                        </li>
                        {% endfor %}

                        {% if user.is_authenticated %}
                            <li>
                                <div class="media wow fadeInDown">
                                    <div class="media-body">
                                        <h4 class="catg_title">Add a Comment</h4>
                                        <form method="post" novalidate>
                                            {% csrf_token %}
                                            <div class="mb-3">
                                                {{ comment_form.as_p }}
                                            </div>
                                            <div class="d-flex gap-2">
                                                <button type="submit" class="btn btn-primary">Submit Comment</button>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </li>
                         {% else %}
                            <p>Please <a href="{% url 'login' %}" style="color: blue;">login</a> to add a comment.</p>   
                        {% endif %}                        


                        {% if user.is_superuser %}
                            <a href="{% url 'news_delete' news.pk news.slug %}" class="btn btn-danger">Delete</a> 
                            <a href="{% url 'news_update' news.pk news.slug %}" class="btn btn-primary">Edit</a>
                        {% endif %}

                    </div>
                    <div class="social_link">
                        <ul class="sociallink_nav">
                            <li><a href="#"><i class="fa fa-facebook"></i></a></li>
                            <li><a href="#"><i class="fa fa-twitter"></i></a></li>
                            <li><a href="#"><i class="fa fa-google-plus"></i></a></li>
                            <li><a href="#"><i class="fa fa-linkedin"></i></a></li>
                            <li><a href="#"><i class="fa fa-instagram"></i></a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-lg-4 col-md-4 col-sm-4">
            <aside class="right_content">
                <div class="single_sidebar">
                    <h2><span>Popular Post</span></h2>
                    <ul class="spost_nav">

                        <ul class="list-unstyled">
                            {% for popular_new in popular_news %}
                            <li class="mb-2">
                                <a href="{% url 'single_page' popular_new.pk popular_new.slug %}" class="d-flex text-decoration-none">
                                    <img class="img-thumbnail me-2" src="{{ popular_new.image.url }}" alt="{{ popular_new.title }}">
                                    <div class="ms-2">
                                        <a href="{% url 'single_page' popular_new.pk popular_new.slug %}" class="catg_title">{{ popular_new.title }}</a>
                                    </div>
                                </a>
                            </li>
                            {% endfor %}
                        </ul>

                    </ul>
                </div>
            </aside>
        </div>
    </div>
</section>
{% endblock content %}